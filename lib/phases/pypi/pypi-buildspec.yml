version: 0.2

env:
  parameter-store:
    TWINE_USERNAME: {{pipeline_name}}.twine_username
    TWINE_PASSWORD: {{pipeline_name}}.twine_password
    TWINE_REPOSITORY: {{pipeline_name}}.twine_repo
    {{#if twine_repo_url}}
    TWINE_REPOSITORY_URL: {{pipeline_name}}.twine_repo
    {{/if}}

phases:
  pre_build:
    commands:
    - pip install twine wheel awscli
    - pip install -r requirements.txt
    - rm -rf dist
  build:
    commands:
    - python setup.py sdist bdist_wheel
    - twine upload dist/*
